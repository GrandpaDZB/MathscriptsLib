参考文献：

- DUAN H B, QIAO P X. Pigeon-inspired optimization: a new swarm intelligence optimizer for air robot path planning[J]. Internati onal 
  Journal of Intelligent Computing and Cybernetics, 2014, 7(1):24-37
- 胡耀龙,冯强,海星朔,任羿.基于自适应学习策略的改进鸽群优化算法[J].北京航空航天大学学报,2020,46(12):2348-2356.



对于本文建立的数学优化模型，由于其繁琐的逻辑运算式和复杂的约束空间，使用基于梯度的优化算法都难以进行。基于自然界中生物种群群体行为建立的启发式优化算法在处理多约束复杂问题时常常具有良好的表现。2014年，Duan和Qiao总结鸽群归巢先参照地球磁场后依照地标记忆的特殊导航过程提出了鸽群优化算法（Pigeon-Inspired Optimization，PIO），广泛应用于无人机编队以及控制参数优化等多维约束优化问题求解。然而传统的鸽群优化算法受目标点以及群体行为的引导不断优化，尽管收敛速度快，但也因此容易陷入局部最优，对于本文所建立的优化模型很难发挥较好的作用。Hu等人在2019年基于自适应学习策略，提出改进的鸽群优化算法（Adaptive Learning Piegon-Inspired Optimization，ALPIO），根据种群竞争行为与自适应策略生成“候选者”对优化问题的更多可行域进行探索，调整策略，论文结果表明ALPIO算法在收敛速度几乎不变的前提下，适应度值显著优于PIO与PSO（粒子群优化算法），使用ALPIO算法对本文的优化模型进行求解得到了很好的结果。

步骤一：设定算法各参数的值，定义种群数量N、搜索空间维数D=50（即订购策略的维数），指南针因子R，地图和指南针算子最大迭代次数T_1，地标算子最大迭代次数T_2，随机初始化种群位置与速度，计算初始适应度

步骤二：更新个体速度和位置，并更新个体最优位置与全局最优位置，个体位置即生成的供应商订购策略$\pi_S$，定义容差T自增
$$
V_i(t)=V_i(t-1)e^{-Rt}+rand\cdot(X_{gbest}-X_i(t-1)) \\
X_i(t)=X_i(t-1)+V_i(t)
$$
其中R为地图与指南针因子，rand为随机生成的[0,1]区间里的随机数，X_{gbest}为全局最优位置，t为迭代次数

在优化算法中，前文定义的损失函数Cost也称作种群适应度，为了便于书写，在本算法中使用X_i代替$\pi_{S,i}$，如果在某一次更新后，所有个体的最优位置没有变化，那么应该满足
$$
\Sigma_{i=1}^N(Cost(X_i(t))-Cost(X_i(t-1)))=0
$$
此时，使容差T自增
$$
T=T+1
$$
步骤三：根据容差策略判断种群全局最优是否仍有竞争力。显然，T越大，说明算法越容易陷入局部最优，为了避免种群陷入，应该调整搜索方向，定义Prob_adjust描述种群调整方向的概率
$$
Prob\_adjust=\frac{e^T-1}{e^{10}-1}
$$
在步骤三中如果满足
$$
Prob\_adjust>rand
$$
则调整种群搜索方向，进入步骤四，否则回到步骤二

步骤四：生成候选者，候选者应充分利用个体最优信息，并保持与全局最优相似的结构，设所有个体最优值的均值为Average，标准差为std，则定义候选者为
$$
Candidate=X_{pbest}(k)\cdot Gaussian(Average,std)
$$
其中Gaussian表示高斯分布

步骤五：基于竞争学习的预测策略修正全局最优。分别使用所有的候选者和当前的全局最优进行种群的速度和位置更新，并计算适应度（也即损失Cost）的变化量
$$
Competitiveness=\Sigma_{i=1}^N(Coss(X_i(t+1))-Cost(X_i(t)))
$$
挑选Competitiveness最大者为种群新的全局最优对象参与后续的迭代。